---
phase: 02-shell-reliability-hardening
plan: 02
type: execute
wave: 2
depends_on:
  - "02-01"
files_modified:
  - zsh/.zshrc
autonomous: true
requirements:
  - SHLL-03
  - SHLL-04
user_setup: []
must_haves:
  truths:
    - `alias a='aliasr'` remains available and unchanged as operator entrypoint.
    - Core helper commands use guarded fallbacks for cross-platform safety.
    - Helper command failures surface actionable messages instead of silent breakage.
  artifacts:
    - zsh/.zshrc
  key_links:
    - zsh/.zshrc:aliasr alias -> shell command surface
    - zsh/.zshrc:helper wrappers -> localip/netinfo/base64/network helper behavior
    - zsh/.zshrc:guard checks -> fallback command paths
---

<objective>
Validate helper commands and add safe compatibility guards in `zsh/.zshrc`.

Purpose: Reduce host-specific breakage while preserving existing helper entrypoints and aliasr workflow.
Output: Hardened helper behavior with explicit fallback/error handling.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-shell-reliability-hardening/02-CONTEXT.md
@.planning/phases/02-shell-reliability-hardening/02-RESEARCH.md
@zsh/.zshrc
@AGENTS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add compatibility wrappers and guarded helper fallback paths</name>
  <files>zsh/.zshrc</files>
  <action>Implement guarded helper logic for platform-variable commands (for example base64 decode flags and optional colorized alias behavior). Preserve current helper names and add fallback paths where command/tool availability differs between hosts.</action>
  <verify>zsh -n zsh/.zshrc</verify>
  <done>Helper commands referenced by `/help` retain their entrypoints and include explicit fallback/guard behavior for cross-host use.</done>
</task>

<task type="auto">
  <name>Task 2: Add helper smoke checks and clear operator-facing error paths</name>
  <files>zsh/.zshrc</files>
  <action>Harden key helper flows (`myip*`, `localip`, `netinfo`, `base64encode/base64decode`) so missing dependencies fail with actionable messages and reachable fallback providers where practical.</action>
  <verify>ZDOTDIR=/opt/dotfiles/zsh zsh -i -c 'alias a | grep -q "aliasr" && base64encode test >/dev/null && base64decode dGVzdA== >/dev/null'</verify>
  <done>Aliasr alias remains intact and representative helper commands execute successfully in shell smoke checks.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `zsh -n zsh/.zshrc` passes
- [ ] `ZDOTDIR=/opt/dotfiles/zsh zsh -i -c 'alias a | grep -q "aliasr"'` passes
- [ ] `ZDOTDIR=/opt/dotfiles/zsh zsh -i -c 'base64decode dGVzdA=='` outputs `test`
- [ ] `ZDOTDIR=/opt/dotfiles/zsh zsh -i -c 'localip >/dev/null && netinfo >/dev/null'` exits 0 with guarded fallbacks
</verification>

<success_criteria>

- aliasr launcher contract remains unchanged
- Helper commands are safer across host differences
- Guarded error handling avoids silent failures

</success_criteria>

<output>
After completion, create `.planning/phases/02-shell-reliability-hardening/02-02-SUMMARY.md`
</output>
